<!doctype html>
<html lang="en">
<head>
<link rel="preconnect" href="https://assets.mailerlite.com" crossorigin>
<meta charset="utf-8" />
<meta http-equiv="x-ua-compatible" content="ie=edge" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AV Solution 3-Pillar Readiness Scorecard</title>

<!-- MailerLite Universal (required for JS embed) -->
<script>
  (function(w,d,e,u,f,l,n){w[f]=w[f]||function(){(w[f].q=w[f].q||[]).push(arguments);};
  l=d.createElement(e);l.async=1;l.src=u;n=d.getElementsByTagName(e)[0];n.parentNode.insertBefore(l,n);})
  (window,document,'script','https://assets.mailerlite.com/js/universal.js','ml');
  ml('account','1191636');
</script>

<!-- Optional: if ML does call this, we unlock too -->
<script>
  function ml_webform_success_31574996(){
    try {
      localStorage.setItem('ml_ok','1');
      if (window.unlockExport) window.unlockExport();
    } catch(e){}
    return false;
  }
</script>

<style>
  :root{
    --bg:#ffffff; --ink:#0b1f35; --muted:#5b6b7e; --panel:#f3f6f9; --line:#e3e8ef;
    --accent:#0b5fff; --accent-ink:#ffffff; --good:#1a7f37; --warn:#ffb100; --risk:#c62828; --radius:16px;
  }
  .chart-container{position:relative;height:250px;width:100%}
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}
  a{color:var(--accent);text-decoration:none}
  a:focus{outline:2px solid var(--accent)}
  .wrap{max-width:1100px;margin-inline:auto;padding:32px 20px}
  header{display:grid;gap:8px;margin-bottom:20px}
  h1{font-size:34px;line-height:1.2;margin:0 0 2px}
  .sub{color:var(--muted)}
  .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:20px}
  @media (max-width:980px){.grid{grid-template-columns:1fr}}
  .card{background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);padding:18px}
  .card h2{font-size:20px;margin:0 0 12px}
  .muted{color:var(--muted)}
  .kpi{display:flex;gap:16px;align-items:center;flex-wrap:wrap;margin:6px 0 0}
  .kpi .pill{background:#fff;border:1px solid var(--line);padding:8px 12px;border-radius:12px;min-width:120px;text-align:center}
  .score-lg{font-size:44px;font-weight:700}
  .bucket{font-weight:700;padding:6px 10px;border-radius:10px;display:inline-block}
  .bucket.good{background:var(--good);color:#fff}
  .bucket.warn{background:var(--warn);color:#111}
  .bucket.risk{background:var(--risk);color:#fff}
  fieldset{border:1px solid var(--line);padding:14px;border-radius:12px;background:#fff;margin:0 0 14px}
  legend{padding:0 6px;font-weight:bold;font-size:1.1em;}
  .qrow{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center;padding:8px 0;border-bottom:1px dashed var(--line)}
  .qrow:last-child{border-bottom:0}
  .opts{display:flex;gap:8px;align-items:center;justify-content:flex-end}
  .opts label{display:inline-flex;align-items:center;gap:6px;background:var(--panel);padding:6px 8px;border:1px solid var(--line);border-radius:8px;cursor:pointer}
  input[type="radio"]{accent-color:var(--accent)}
  .hint{font-size:13px;color:var(--muted)}
  .actions{display:flex;gap:10px;flex-wrap:wrap}
  button{appearance:none;border:0;border-radius:10px;background:var(--accent);color:var(--accent-ink);padding:12px 14px;font-weight:600;cursor:pointer}
  button[disabled]{opacity:.55;cursor:not-allowed}
  .link-btn{background:#fff;color:var(--accent);border:1px solid var(--line)}
  .foot{margin-top:18px;font-size:13px;color:var(--muted)}
  .hr{height:1px;background:var(--line);margin:20px 0}
  .notice{background:#fff8e1;border:1px solid #ffe5a7;border-radius:12px;padding:10px 12px}
  .ml-embedded{isolation:isolate}
</style>
</head>

<body>
<div class="wrap" id="top">
  <header>
    <h1>AV Solution 3-Pillar Readiness Scorecard</h1>
    <p class="sub">Assess your AV-over-IP strategy against the 3 Pillars of a zero-downtime deployment: Design, Security, and Operations.</p>
  </header>

  <div class="grid">
    <main aria-labelledby="questions-title">
      <div class="card">
        <h2 id="questions-title">Readiness Assessment</h2>
        <p class="muted">Select the option that best reflects your current state. Your pillar scores will update live.</p>

        <fieldset>
          <legend>Pillar 1: Design &amp; Interop</legend>

          <div class="qrow">
            <div><strong>PTP Domain Design</strong><div class="hint">Dedicated domains, BMCA strategy, GM resilience</div></div>
            <div class="opts" role="radiogroup" aria-label="PTP domain design">
              <label><input type="radio" name="q1" value="0" data-pillar="Design">None</label>
              <label><input type="radio" name="q1" value="1" data-pillar="Design">Partial</label>
              <label><input type="radio" name="q1" value="2" data-pillar="Design">Documented</label>
            </div>
          </div>

          <div class="qrow">
            <div><strong>Grandmaster Redundancy</strong><div class="hint">Dual GM, holdover, failover tests</div></div>
            <div class="opts" role="radiogroup" aria-label="Grandmaster redundancy">
              <label><input type="radio" name="q2" value="0" data-pillar="Design">Single GM</label>
              <label><input type="radio" name="q2" value="1" data-pillar="Design">Warm spare</label>
              <label><input type="radio" name="q2" value="2" data-pillar="Design">Active failover</label>
            </div>
          </div>

          <div class="qrow">
            <div><strong>Multicast Safety</strong><div class="hint">IGMPv3, PIM/SDM, RP/BSR, guardrails</div></div>
            <div class="opts" role="radiogroup" aria-label="Multicast safety">
              <label><input type="radio" name="q3" value="0" data-pillar="Design">Unmanaged</label>
              <label><input type="radio" name="q3" value="1" data-pillar="Design">Basic IGMP</label>
              <label><input type="radio" name="q3" value="2" data-pillar="Design">Engineered</label>
            </div>
          </div>

          <div class="qrow">
            <div><strong>QoS &amp; Queues</strong><div class="hint">LLQ/priority, policing, WRED disabled where needed</div></div>
            <div class="opts" role="radiogroup" aria-label="QoS">
              <label><input type="radio" name="q4" value="0" data-pillar="Design">Best-effort</label>
              <label><input type="radio" name="q4" value="1" data-pillar="Design">Partial</label>
              <label><input type="radio" name="q4" value="2" data-pillar="Design">End-to-end</label>
            </div>
          </div>

          <div class="qrow">
            <div><strong>Open Standards Adoption</strong><div class="hint">NMOS, AES67/ST 2110 interop validated</div></div>
            <div class="opts" role="radiogroup" aria-label="Standards">
              <label><input type="radio" name="q7" value="0" data-pillar="Design">None</label>
              <label><input type="radio" name="q7" value="1" data-pillar="Design">Partial</label>
              <label><input type="radio" name="q7" value="2" data-pillar="Design">Adopted</label>
            </div>
          </div>
        </fieldset>

        <fieldset>
          <legend>Pillar 2: Security &amp; Policy</legend>

          <div class="qrow">
            <div><strong>Segmentation</strong><div class="hint">VRF/VLAN, ACLs, zero-trust policy</div></div>
            <div class="opts" role="radiogroup" aria-label="Segmentation">
              <label><input type="radio" name="q5" value="0" data-pillar="Security">Flat</label>
              <label><input type="radio" name="q5" value="1" data-pillar="Security">Basic</label>
              <label><input type="radio" name="q5" value="2" data-pillar="Security">Policy-driven</label>
            </div>
          </div>

          <div class="qrow">
            <div><strong>Identity &amp; Access</strong><div class="hint">802.1X/MAB, device inventory, RBAC</div></div>
            <div class="opts" role="radiogroup" aria-label="Identity">
              <label><input type="radio" name="q6" value="0" data-pillar="Security">Ad-hoc</label>
              <label><input type="radio" name="q6" value="1" data-pillar="Security">Partial</label>
              <label><input type="radio" name="q6" value="2" data-pillar="Security">Managed</label>
            </div>
          </div>

          <div class="qrow">
            <div><strong>Change Control</strong><div class="hint">CAB, windowing, rollback plan, audit trails</div></div>
            <div class="opts" role="radiogroup" aria-label="Change">
              <label><input type="radio" name="q12" value="0" data-pillar="Security">Informal</label>
              <label><input type="radio" name="q12" value="1" data-pillar="Security">Partial</label>
              <label><input type="radio" name="q12" value="2" data-pillar="Security">Disciplined</label>
            </div>
          </div>
        </fieldset>

        <fieldset>
          <legend>Pillar 3: Operations &amp; Observability</legend>

          <div class="qrow">
            <div><strong>Routing &amp; API Orchestration</strong><div class="hint">Northbound APIs, repeatable provisioning</div></div>
            <div class="opts" role="radiogroup" aria-label="Routing">
              <label><input type="radio" name="q8" value="0" data-pillar="Operations">Manual</label>
              <label><input type="radio" name="q8" value="1" data-pillar="Operations">Scripts</label>
              <label><input type="radio" name="q8" value="2" data-pillar="Operations">Controller</label>
            </div>
          </div>

          <div class="qrow">
            <div><strong>Observability & Telemetry</strong><div class="hint">Telemetry for PTP, multicast, QoS, device health</div></div>
            <div class="opts" role="radiogroup" aria-label="Observability">
              <label><input type="radio" name="q9" value="0" data-pillar="Operations">None</label>
              <label><input type="radio" name="q9" value="1" data-pillar="Operations">Partial</label>
              <label><input type="radio" name="q9" value="2" data-pillar="Operations">Dashboards + alerts</label>
            </div>
          </div>

          <div class="qrow">
            <div><strong>Rollback &amp; Backups</strong><div class="hint">Golden configs, versioned restores, drills</div></div>
            <div class="opts" role="radiogroup" aria-label="Rollback">
              <label><input type="radio" name="q10" value="0" data-pillar="Operations">Ad-hoc</label>
              <label><input type="radio" name="q10" value="1" data-pillar="Operations">Backups</label>
              <label><input type="radio" name="q10" value="2" data-pillar="Operations">Tested DR</label>
            </div>
          </div>

          <div class="qrow">
            <div><strong>Pre-Launch Validation</strong><div class="hint">Load/latency tests, failure injection</div></div>
            <div class="opts" role="radiogroup" aria-label="Prelaunch">
              <label><input type="radio" name="q11" value="0" data-pillar="Operations">None</label>
              <label><input type="radio" name="q11" value="1" data-pillar="Operations">Basic</label>
              <label><input type="radio" name="q11" value="2" data-pillar="Operations">Formal</label>
            </div>
          </div>
        </fieldset>

        <div class="actions">
          <button type="button" class="link-btn" id="recalcBtn" title="Recalculate score">Recalculate score</button>
          <button type="button" id="exportBtn" disabled title="Subscribe to unlock your personalized action plan">Get My Personalized Action Plan</button>
        </div>
        <div class="foot">Action Plan export is unlocked after you subscribe via the form.</div>
      </div>
    </main>

    <aside>
      <div class="card" aria-live="polite" aria-atomic="true">
        <h2>Your Readiness Score</h2>
        <div class="kpi">
          <div class="pill"><span class="muted">Total</span><div class="score-lg" id="scoreTotal">0%</div><div class="muted" id="scoreRaw" style="font-size:12px;">0 / 24</div></div>
          <div class="pill"><span class="muted">Readiness</span><div id="scoreBucket" class="bucket risk">At Risk</div></div>
          <div class="pill"><span class="muted">TCO Multiplier</span><div class="score-lg" id="tcoMult">1.00×</div></div>
        </div>

        <div class="hr"></div>

        <div class="chart-container">
          <canvas id="scoreChart" role="img" aria-label="Readiness breakdown by pillar"></canvas>
        </div>

        <div class="hr"></div>

        <div id="pillarScores"></div>

        <div class="hr"></div>

        <div class="notice">Get your personalized action plan by subscribing below.</div>
      </div>

      <div class="card" id="subscribe">
        <h2>Unlock Your Action Plan</h2>
        <!-- JS Embed target -->
        <div class="ml-embedded" data-form="2yvzIn"></div>
        <noscript>This form requires JavaScript.</noscript>
        <p class="foot">Subscriptions are processed by MailerLite.</p>
      </div>
    </aside>
  </div>

  <footer class="foot">
    © Flicktronix. Vendor-neutral assessment. No client data is collected beyond form fields handled by MailerLite.
  </footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>

<script>
/* Unlock helpers + listeners */
(function(){
  var exportBtn = document.getElementById("exportBtn");
  function unlock(){
    if(!exportBtn) return;
    exportBtn.removeAttribute("disabled");
    exportBtn.title = "Download your personalized action plan (.pdf)";
  }
  window.unlockExport = unlock;               // expose for other callbacks
  if (localStorage.getItem("ml_ok")==="1") unlock();

  // Some ML variants postMessage on success
  window.addEventListener("message", function(ev){
    try{
      var d = ev.data;
      if ((typeof d === "string" && d.indexOf("ml:form:success") !== -1) ||
          (d && d.type === "ml:form:success")) {
        localStorage.setItem("ml_ok","1");
        unlock();
      }
    }catch(e){}
  }, false);

  // Robust path: watch injected DOM for success body becoming visible
  var host = document.getElementById('subscribe');
  if (host) {
    var mo = new MutationObserver(function(){
      var okPane = host.querySelector('.ml-form-successBody');
      if (okPane && getComputedStyle(okPane).display !== 'none') {
        localStorage.setItem("ml_ok","1");
        unlock();
      }
    });
    mo.observe(host, {subtree:true, attributes:true, childList:true, attributeFilter:['style','class']});
  }
})();
</script>

<script>
/* ---------- Scoring ---------- */
const PILLARS = {
  "Design": { label: "Design & Interop", max: 10 },
  "Security": { label: "Security & Policy", max: 6 },
  "Operations": { label: "Operations & Observability", max: 8 }
};
const PILLAR_KEYS = Object.keys(PILLARS);

function computeScore(){
  let total = 0;
  const byPillar = Object.fromEntries(PILLAR_KEYS.map(p => [p, 0]));
  const maxScore = PILLAR_KEYS.reduce((sum, key) => sum + PILLARS[key].max, 0);

  const inputs = document.querySelectorAll('input[type="radio"][data-pillar]:checked');
  inputs.forEach(inp => {
    const v = Number(inp.value || 0);
    const pillar = inp.dataset.pillar;
    if (byPillar.hasOwnProperty(pillar)) {
      total += v;
      byPillar[pillar] += v;
    }
  });

  const pct = maxScore > 0 ? Math.round((total / maxScore) * 100) : 0;
  const shortfall = Math.max(0, 70 - pct);
  const tcoMultiplier = +(1 + (shortfall / 100) * 0.5).toFixed(2);

  return { total, byPillar, max: maxScore, pct, tcoMultiplier };
}

function bucketFromScore(pct){
  if (pct >= 80) return "Robust";
  if (pct >= 50) return "Emerging";
  return "At Risk";
}

function updateScoreUI(){
  const { total, byPillar, max, pct, tcoMultiplier } = computeScore();
  const bucket = bucketFromScore(pct);

  document.getElementById("scoreTotal").textContent = `${pct}%`;
  document.getElementById("scoreRaw").textContent = `${total} / ${max}`;

  const b = document.getElementById("scoreBucket");
  b.textContent = bucket;
  b.classList.remove("good","warn","risk");
  if (bucket === "Robust") b.classList.add("good");
  else if (bucket === "Emerging") b.classList.add("warn");
  else b.classList.add("risk");

  document.getElementById("tcoMult").textContent = `${tcoMultiplier.toFixed(2)}×`;

  renderChart(byPillar);
  renderPillarScores(byPillar);

  return { score: total, bucket, pct, byPillar, tcoMultiplier };
}

function renderPillarScores(byPillar) {
  const container = document.getElementById("pillarScores");
  let html = '<h3 style="margin:8px 0 6px">Pillar Breakdown</h3>';
  PILLAR_KEYS.forEach(key => {
    const score = byPillar[key] || 0;
    const max = PILLARS[key].max;
    const percent = max > 0 ? Math.round((score / max) * 100) : 0;
    html += `<div style="display:flex;justify-content:space-between;align-items:center;padding:4px 0;">
               <span><strong>${PILLARS[key].label}</strong></span>
               <span>${score} / ${max} (${percent}%)</span>
             </div>`;
  });
  container.innerHTML = html;
}

/* ---------- Chart ---------- */
let chart;
function renderChart(byPillar){
  const ctx = document.getElementById('scoreChart').getContext('2d');
  const data = PILLAR_KEYS.map(k => byPillar[k] || 0);
  const labels = PILLAR_KEYS.map(k => PILLARS[k].label);
  const maxValues = PILLAR_KEYS.map(k => PILLARS[k].max);

  if (chart){
    chart.data.labels = labels;
    chart.data.datasets[0].data = data;
    chart.options.scales.r.suggestedMax = Math.max(...maxValues);
    chart.update();
    return;
  }

  chart = new Chart(ctx, {
    type: 'radar',
    data: {
      labels,
      datasets: [{
        label: 'Pillar Score',
        data,
        fill: true,
        backgroundColor: 'rgba(11, 95, 255, 0.2)',
        borderColor: 'rgb(11, 95, 255)',
        pointBackgroundColor: 'rgb(11, 95, 255)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgb(11, 95, 255)'
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false } },
      scales: {
        r: { suggestedMin: 0, suggestedMax: Math.max(...maxValues), ticks: { stepSize: 2 } }
      }
    }
  });
}

/* ---------- Export ---------- */
function getPriorityAdvice(byPillar) {
  let lowestPillar = '';
  let lowestPercent = 101;

  PILLAR_KEYS.forEach(key => {
    const score = byPillar[key] || 0;
    const max = PILLARS[key].max;
    const percent = max > 0 ? (score / max) * 100 : 0;
    if (percent < lowestPercent) {
      lowestPercent = percent;
      lowestPillar = key;
    }
  });

  const advice = {
    "Design": [
      "Your lowest score is in Design & Interop. This suggests foundational risks in system timing, media transport, and compatibility.",
      "Immediate Focus Areas:",
      "- Validate your PTP/clocking design, ensuring you have a resilient Grandmaster strategy.",
      "- Engineer your multicast network with IGMP Snooping/Querier and proper boundaries to prevent flooding.",
      "- Implement end-to-end QoS to protect critical AV flows from packet loss and jitter."
    ],
    "Security": [
      "Your lowest score is in Security & Policy. Your system may be vulnerable to unauthorized access or disruptive changes.",
      "Immediate Focus Areas:",
      "- Implement network segmentation (VLANs/VRFs) to isolate AV traffic from general corporate traffic.",
      "- Develop an access control policy using 802.1X or MAB to ensure only authorized devices can connect.",
      "- Establish a formal change control process (CAB, maintenance windows) to prevent unplanned outages."
    ],
    "Operations": [
      "Your lowest score is in Operations & Observability. This indicates potential challenges in monitoring, troubleshooting, and recovering from failures.",
      "Immediate Focus Areas:",
      "- Deploy monitoring tools to gain telemetry on PTP sync, multicast flows, and QoS drops.",
      "- Establish an automated backup process for all critical device configurations.",
      "- Create and test a disaster recovery (DR) plan, including rollback procedures for failed changes."
    ]
  };

  return advice[lowestPillar] || ["Review all pillars to identify specific areas for improvement."];
}

function exportWorksheet(){
  const { score, bucket, pct, byPillar, tcoMultiplier } = updateScoreUI();

  const lines = [];
  lines.push("Flicktronix AV Readiness — Executive Action Plan");
  lines.push("================================================");
  lines.push("");
  lines.push(`Overall Readiness: ${pct}%  |  Tier: ${bucket}  |  Estimated TCO Multiplier: ${tcoMultiplier}×`);
  lines.push("");
  lines.push("--- Pillar Breakdown ---");
  PILLAR_KEYS.forEach(key => {
    const pScore = byPillar[key] || 0;
    const pMax = PILLARS[key].max;
    const pPct = pMax > 0 ? Math.round((pScore / pMax) * 100) : 0;
    lines.push(`- ${PILLARS[key].label}: ${pPct}% (${pScore} / ${pMax})`);
  });
  lines.push("");
  lines.push("--- Recommended Next Steps ---");
  getPriorityAdvice(byPillar).forEach(line => lines.push(line));
  lines.push("");
  lines.push("--- 20-Minute Readout ---");
  lines.push("We’ll validate assumptions and map a 3-week stabilization plan (guardrails + quick wins).");
  lines.push(">>> [https://calendar.app.google/2pHsE1fCpm3SWjzn6]");
  lines.push("");

  const blob = new Blob([lines.join("\n")], {type:"text/plain;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "Flicktronix_AV_Action_Plan.pdf";
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
}

/* ---------- Wire-up ---------- */
document.addEventListener("change", (e)=>{
  if (e.target.matches('input[type="radio"][data-pillar]')) updateScoreUI();
});
document.getElementById("recalcBtn").addEventListener("click", updateScoreUI);
document.getElementById("exportBtn").addEventListener("click", exportWorksheet);

/* Initial render */
updateScoreUI();
</script>

<script>
/* Persist answers so the form doesn’t reset */
document.addEventListener("change", e=>{
  if(e.target.matches('input[type="radio"][data-pillar]')){
    const answers={};
    document.querySelectorAll('input[type="radio"][data-pillar]:checked').forEach(i=>answers[i.name]=i.value);
    localStorage.setItem("answers",JSON.stringify(answers));
  }
});
window.addEventListener("DOMContentLoaded",()=>{
  const saved=JSON.parse(localStorage.getItem("answers")||"{}");
  Object.entries(saved).forEach(([k,v])=>{
    const el=document.querySelector(`input[name="${k}"][value="${v}"]`);
    if(el) el.checked=true;
  });
  updateScoreUI();
});
</script>
</body>
</html>
